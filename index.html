<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Admin — henrikworld.com</title>
<style>
  body {
    margin: 0;
    background: white;
    color: black;
    font-family: monospace;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh;
    gap: 10px;
  }
  textarea {
    width: 80%;
    max-width: 600px;
    height: 120px;
    font-family: monospace;
    font-size: 16px;
    line-height: 1.5;
    padding: 10px;
    border: 1px solid #ccc;
    resize: none;
  }
  button {
    width: 80%;
    max-width: 600px;
    padding: 10px;
    font-family: monospace;
    font-size: 14px;
    cursor: pointer;
    background: #eee;
    border: 1px solid #ccc;
  }
  button:hover { background: #ddd; }
  .status { font-size: 13px; color: #444; width: 80%; max-width: 600px; }
</style>
</head>
<body>

<textarea id="editor" placeholder="Enter commands here:  
Line 1: admin/account/create/username=USERNAME
Line 2: admin/account/create/password=PASSWORD"></textarea>
<button id="saveBtn">Save</button>
<div class="status" id="status">Status: idle</div>

<script type="module">
import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.6.1/firebase-app.js';
import { getFirestore, collection, addDoc, serverTimestamp } from 'https://www.gstatic.com/firebasejs/10.6.1/firebase-firestore.js';

const firebaseConfig = {
  apiKey: "AIzaSyAMk8qcZl_VGk-4sz8Z8uXPWnOFyXbiH-8",
  authDomain: "henrikworldonline.firebaseapp.com",
  projectId: "henrikworldonline",
  storageBucket: "henrikworldonline.firebasestorage.app",
  messagingSenderId: "87537574197",
  appId: "1:87537574197:web:1febedd14bc819150a2c7c",
  measurementId: "G-6ZGQ9E87P7"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const editor = document.getElementById('editor');
const saveBtn = document.getElementById('saveBtn');
const status = document.getElementById('status');

function parseLines(lines) {
  if (lines.length !== 2) return null;
  const usernameMatch = lines[0].match(/^admin\/account\/create\/username=(.+)$/);
  const passwordMatch = lines[1].match(/^admin\/account\/create\/password=(.+)$/);
  if (!usernameMatch || !passwordMatch) return null;
  return { username: usernameMatch[1], password: passwordMatch[1] };
}

async function saveAccount(account) {
  try {
    await addDoc(collection(db, 'accounts'), { username: account.username, password: account.password, createdAt: serverTimestamp() });
    return true;
  } catch(e) { console.error(e); return false; }
}

saveBtn.addEventListener('click', async () => {
  status.textContent = 'Status: processing...';
  const lines = editor.value.split('\n').map(l => l.trim());
  const account = parseLines(lines);
  if (!account) {
    status.textContent = 'Status: Error — invalid format. Enter username then password.';
    return;
  }
  const success = await saveAccount(account);
  if (success) {
    status.textContent = `Status: Account "${account.username}" created successfully!`;
    editor.value = '';
  } else {
    status.textContent = 'Status: Error saving account.';
  }
});
</script>

</body>
</html>
